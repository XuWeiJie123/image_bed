########################强制https跳转#########################
#server {
#        listen 80 default_server;
#        server_name _;
#        return 301 $scheme://web.eduhiker.com$request_uri;
#        access_log off;
#}
##############################################################

server {
        listen       80;
        server_name  localhost;

		location / {
            root   /data/htdocs/static/dist;
	        try_files $uri $uri/ /index.html;
            index index.html index.htm index_v1.html;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
}



#####web vue##########
server {
    listen 80;
    server_name web.eduhiker.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}

server {
    listen 443 ssl;
    ssl_certificate  /etc/nginx/sites/key/web.pem;
    ssl_certificate_key  /etc/nginx/sites/key/web.key;
	server_name  web.eduhiker.com;
    location ~* \.(txt|xml)$ {
        root /data/htdocs/main;
    }
location ^~/websocket/ {
        proxy_set_header X-Real_IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header X_Forward_For $proxy_add_x_forwarded_for;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Origin "";
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/mainPath/ {
	proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
	proxy_pass http://127.0.0.1:14000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/shopPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:14000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/examPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:14000;
        proxy_set_header Host $host:$server_port;
    }
    add_header   Access-Control-Allow-Origin *;
    location /  {
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_redirect  off;
        proxy_pass http://127.0.0.1:8088;
    }
}

#####admin vue##########
server {
    listen 80;
    server_name admin.eduhiker.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}

server {
    listen 443 ssl;
    ssl_certificate  /etc/nginx/sites/key/admin.pem;
    ssl_certificate_key  /etc/nginx/sites/key/admin.key;
	server_name  admin.eduhiker.com;

    location ^~/mainPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:14000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/shopPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:14000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/examPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:14000;
        proxy_set_header Host $host:$server_port;
    }
    location /  {
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_redirect  off;
        proxy_pass http://127.0.0.1:8090;
    }
}

#####testvue##########
server {
    listen 80;
    server_name e.eduhiker.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}

server {
    listen 443 ssl;
    ssl_certificate  /etc/nginx/sites/key/e.pem;
    ssl_certificate_key  /etc/nginx/sites/key/e.key;
	server_name  e.eduhiker.com;
    location ^~/websocket/ {
        proxy_set_header X-Real_IP $remote_addr;
        proxy_set_header Host $host;
        proxy_set_header X_Forward_For $proxy_add_x_forwarded_for;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Origin "";
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/mainPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/shopPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/examPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    add_header   Access-Control-Allow-Origin *;
    location /  {
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_redirect  off;
        proxy_pass http://127.0.0.1:9089;
    }
}
#####test web vue##########
server {
    listen 80;
    server_name testweb.eduhiker.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}

server {
    listen 443 ssl;
    ssl_certificate  /etc/nginx/sites/key/testweb.pem;
    ssl_certificate_key  /etc/nginx/sites/key/testweb.key;
	server_name  testweb.eduhiker.com;
location ~* \.(txt|xml)$ {
        root /data/htdocs/main;
    }
    location ^~/mainPath/ {
        proxy_set_header X-Real-IP $remote_addr;
       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/shopPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/examPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    add_header   Access-Control-Allow-Origin *;
    location /  {
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_redirect  off;
        proxy_pass http://127.0.0.1:9089;
    }
}

#####test admin vue##########
server {
    listen 80;
    server_name testadmin.eduhiker.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}

server {
    listen 443 ssl;
    ssl_certificate  /etc/nginx/sites/key/testadmin.pem;
    ssl_certificate_key  /etc/nginx/sites/key/testadmin.key;
	server_name  testadmin.eduhiker.com;

    location ^~/mainPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/shopPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    location ^~/examPath/ {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://127.0.0.1:13000;
        proxy_set_header Host $host:$server_port;
    }
    add_header   Access-Control-Allow-Origin *;
    location /  {
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_redirect  off;
        proxy_pass http://127.0.0.1:9090;
    }
}




############main##########
server {
    listen 80;
    server_name demo.eduhiker.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}
server {
        listen 443 ssl;
        ssl_certificate  /etc/nginx/sites/key/demo.pem;
        ssl_certificate_key  /etc/nginx/sites/key/demo.key;

        server_name demo.eduhiker.com;
        set $docbasexc  /data/htdocs/v2/main;
        set $tomcatxc 127.0.0.1:2081;
        include /etc/nginx/sites/xc/v2.conf;
}
############main#########
############shop##########
server {
    listen 80;
    server_name ke.eduhiker.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}

server {
        listen 443 ssl;
        ssl_certificate  /etc/nginx/sites/key/ke.pem;
        ssl_certificate_key  /etc/nginx/sites/key/ke.key;

        server_name ke.eduhiker.com;
        set $docbasexc  /data/htdocs/v2/shop;
        set $tomcatxc 127.0.0.1:2082;
        include /etc/nginx/sites/xc/v2.conf;
}
############shop##########
############exam##########
server {
    listen 80;
    server_name st.eduhiker.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}

server {
        listen 443 ssl;
        ssl_certificate  /etc/nginx/sites/key/st.pem;
        ssl_certificate_key  /etc/nginx/sites/key/st.key;

        server_name st.eduhiker.com;
        set $docbasexc  /data/htdocs/v2/exam;
        set $tomcatxc 127.0.0.1:2085;
        include /etc/nginx/sites/xc/v2.conf;
}



##########static##########

server {
    listen 443 ssl;
    ssl_certificate  /etc/nginx/sites/key/ss1.pem;
    ssl_certificate_key  /etc/nginx/sites/key/ss1.key;

    server_name ss1.eduhiker.com;
    set $docbasexc  /data/htdocs/v2/static;
    include /etc/nginx/sites/xc/2.conf;
    add_header   Access-Control-Allow-Origin *;



}

server {
        listen 80;
        server_name z.eduhiker.com;
        set $docbasexc  /data/htdocs/main;
        set $tomcatxc 127.0.0.1:8081;
        include /etc/nginx/sites/xc/v2.conf;
}
